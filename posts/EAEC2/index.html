<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Enterprise Attacker Emulation and C2 Implant Development w/ Joff Thyer" /><meta property="og:locale" content="en_US" /><meta name="description" content="Enterprise Attacker Emulation and C2 Implant Development w/ Joff Thyer" /><meta property="og:description" content="Enterprise Attacker Emulation and C2 Implant Development w/ Joff Thyer" /><link rel="canonical" href="https://otterlyoffensive.com/posts/EAEC2/" /><meta property="og:url" content="https://otterlyoffensive.com/posts/EAEC2/" /><meta property="og:site_name" content="Otterly Offensive" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-05-10T00:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Enterprise Attacker Emulation and C2 Implant Development w/ Joff Thyer" /><meta name="twitter:site" content="@RedTeamOtter" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"mainEntityOfPage":{"@type":"WebPage","@id":"https://otterlyoffensive.com/posts/EAEC2/"},"description":"Enterprise Attacker Emulation and C2 Implant Development w/ Joff Thyer","url":"https://otterlyoffensive.com/posts/EAEC2/","@type":"BlogPosting","headline":"Enterprise Attacker Emulation and C2 Implant Development w/ Joff Thyer","dateModified":"2021-08-12T13:44:06-05:00","datePublished":"2021-05-10T00:00:00-05:00","@context":"https://schema.org"}</script><title>Enterprise Attacker Emulation and C2 Implant Development w/ Joff Thyer | Otterly Offensive</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/oo_logo.jpg"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/oo_logo.jpg"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/oo_logo.jpg"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/oo_logo.jpg"><meta name="apple-mobile-web-app-title" content="Otterly Offensive"><meta name="application-name" content="Otterly Offensive"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/favicons/oo_logo.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Otterly Offensive</a></div><div class="site-subtitle font-italic">Otter chaos shall insue</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Enterprise Attacker Emulation and C2 Implant Development w/ Joff Thyer</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Enterprise Attacker Emulation and C2 Implant Development w/ Joff Thyer</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Mr. Otterly </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, May 10, 2021, 12:00 AM -0500" > May 10 <i class="unloaded">2021-05-10T00:00:00-05:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Aug 12, 2021, 1:44 PM -0500" prefix="Updated "> Aug 12 <i class="unloaded">2021-08-12T13:44:06-05:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="711 words">3 min</span></div></div><div class="post-content"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 540'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/favicons/eac2.png" class="preview-img" alt="image alternative text" width="1200" height="540"><h1 id="enterprise-attacker-emulation-and-c2-implant-development-w-joff-thyer">Enterprise Attacker Emulation and C2 Implant Development w/ Joff Thyer</h1><p>In May 2021, I had the pleasure of sitting in the virtual iteration of <em>Wild West Hacking Fest’s</em> training offering written and taught by <em><a href="https://twitter.com/joff_thyer">Joff Thyer</a></em> called <em>Enterprise Attacker Emulation and C2 Implant Development</em></p><p>To save time here is the link to the course: <a href="https://wildwesthackinfest.com/antisyphon//enterprise-attacker-emulation-and-c2-implant-development-w-joff-thyer/">Enterprise Attacker Emulation and C2 Implant Development w/ Joff Thyer</a></p><p>The breakdown of the course content goes like this:</p><ul><li>Module 1: Commodity C2 Frameworks<li>Module 2: The Defense Landscape<li>Module 3: Threat Modeling and Attacker Emulation<li>Module 4: Anatomy of a C2 Channel<li>Module 5: Open C2 RAT Framework<li>Module 6: Your own C#/.NET Implant<li>Module 7: Living off The Land<li>Module 8: Python OpenC2Rat Implant<li>Module 9: Shellcode Execution with Python<li>Module 10: Shellcode Execution with GOLang<li>Module 11: GOLang and .NET<li>Module 12: Shellcode Execution with C#<li>Module 13: Wrapping up and Future Directions</ul><p><img data-proofer-ignore data-src="/assets/img/EncodedDLL.png" alt="EncodedDLLs" /></p><hr /><h3 id="bluf-bottom-line-up-front">BLUF (Bottom Line Up Front)</h3><p><em>If the course description peeks your interest, TAKE THE COURSE.</em></p><p>I really debated doing a comprehensive write-up and assessment of course however, the more I thought about it just did not make sense.</p><p>Why you might ask?</p><p>Glad you did.</p><p>Well…frankly, because if anyone reading this post has any interest in the topics outlined above, should just take the course. That is my honest assessment.</p><p>The cost of this course was $495 but as I told Joff during the training, I feel the <em>Content per $</em> value of his course far exceeds any other offering I have taken in recent years by a massive margin.</p><p>The materials in this course are fresh and relevant. In some cases it was <em>real time</em>, in that changes needed to be made on the fly to bypass detections that previously were not triggering. The real time need to modify code really highlighted ever-changing landscape that is offensive tooling, and presented a very real world scenario.</p><p>It was abundantly clear that Joff had poured immense amount of time and effort building this course and the content provided to the students was off the chart. To start, you receive code to a completely custom C2 framework that was created purposely for this course, an entire framework…nice.</p><p>The sheer amount of code that comes included with course is pretty impressive. I cannot really imagine just how much time went into the development of the code and that alone makes the price of admission a complete steal. Not only are students provided access to the code repos for the course but Joff is gracious enough to provide students with keys to be able to pull the latest versions of the code for a period of 180 days, post taking the course. This means as he continues to refine the content, students that have recently taken the course can benefit from those refinements. Again this is value that keeps going beyond the timeline of the course.</p><p><img data-proofer-ignore data-src="/assets/img/eac2_openc2.png" alt="OpenC2Rat" /></p><p>In terms of the content, a lot of the concepts were not new for me in the least but having it in the context of a completely new C2 framework was great.</p><p>I took a lot away from the course that I have been able to leverage in my day job but none more valuable to me was the use of pre- / post-build events in Visual Studio. Not being a programmer and only recently starting to develop some dotNet tooling, pre- / post-build events were not something I had ever used or frankly new about. Since learning about them, it painfully obvious that they would exist but who knew?!?! Not me. Having the ability to modify my code at compilation time with techniques such as encoding, encrypting, and other obfuscation processes automatically is a game changer for myself. I was already doing all of this, but it was a manual process and frankly could be error-prone.</p><p><img data-proofer-ignore data-src="/assets/img/eac2_build_events.png" alt="Visual Studio Build Events" /></p><p>I am a fan of automation where ever possible and this has been the golden ticket for me. Despite all the work and code that went into this course, it was this little nugget that helped me the most. This will be a tool in my arsenal moving forward for sure.</p><h3 id="tldr">TL/DR</h3><p>The <em>Enterprise Attacker Emulation and C2 Implant Development w/ Joff Thyer</em> was great, and I could not recommend it more.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/training/'>Training,</a>, <a href='/categories/wwhf/'>WWHF</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/c2/" class="post-tag no-text-decoration" >c2</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Enterprise Attacker Emulation and C2 Implant Development w/ Joff Thyer - Otterly Offensive&url=https://otterlyoffensive.com/posts/EAEC2/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Enterprise Attacker Emulation and C2 Implant Development w/ Joff Thyer - Otterly Offensive&u=https://otterlyoffensive.com/posts/EAEC2/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Enterprise Attacker Emulation and C2 Implant Development w/ Joff Thyer - Otterly Offensive&url=https://otterlyoffensive.com/posts/EAEC2/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/EDR-Evasion-Lab-Part-1/">EDR Evasion Lab: Part 1</a><li><a href="/posts/EAEC2/">Enterprise Attacker Emulation and C2 Implant Development w/ Joff Thyer</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/c2/">c2</a> <a class="post-tag" href="/tags/edr/">edr,</a> <a class="post-tag" href="/tags/evasion/">evasion,</a> <a class="post-tag" href="/tags/implant/">implant.</a> <a class="post-tag" href="/tags/redteam/">redteam</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/EDR-Evasion-Lab-Part-1/"><div class="card-body"> <span class="timeago small" > Aug 12 <i class="unloaded">2021-08-12T00:00:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>EDR Evasion Lab: Part 1</h3><div class="text-muted small"><p> EDR Evasion Lab: Part 1 Genesis In January 2021, I finally passed Offensive Security’s OSCE course and exam after a couple of failed attempts for various. While this was super exciting to have ta...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/EDR-Evasion-Lab-Part-1/" class="btn btn-outline-primary" prompt="Newer"><p>EDR Evasion Lab: Part 1</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/RedTeamOtter">Mr. Otterly</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/c2/">c2</a> <a class="post-tag" href="/tags/edr/">edr,</a> <a class="post-tag" href="/tags/evasion/">evasion,</a> <a class="post-tag" href="/tags/implant/">implant.</a> <a class="post-tag" href="/tags/redteam/">redteam</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://otterlyoffensive.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script>
